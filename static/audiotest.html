<html>
    <head>
        <title>Audio Test</title>
        <script>

            if (!window.AudioContext) {
                window.AudioContext = window.webkitAudioContext;
            }
            var audioContext = new AudioContext();

            function loadSound(url, ctx, onSuccess, onError) {
                var request = new XMLHttpRequest();
                request.open('GET', url, true);
                request.responseType = 'arraybuffer'; // Important trick
                request.onload = function(){
                    ctx.decodeAudioData(
                            request.response,
                            function(buffer) {
                                onSuccess && onSuccess(buffer);
                            },
                            function(){
                                onError && onError();
                            }
                    );
                };
                request.send();
            }

            function playSound(ctx, buffer) {
                var source = ctx.createBufferSource();
                source.buffer = buffer;
                source.connect(ctx.destination);
                source.start(0);
            }

            function initSound(url){
                var result = {
                    play: function(){},
                    setVolume: function(){}
                };
                loadSound(url, audioContext, function(buffer){
                    result.play = function(){
                        playSound(audioContext, buffer);
                    };
                });
                return result;
            }

            var appearAudio = initSound('resources/audio/effects/appear.mp3');

            var onButtonClick = function(){
                appearAudio.play();
            }
        </script>
    </head>
    <body>
        <button onclick="onButtonClick();">Sound</button>
    </body>
</html>